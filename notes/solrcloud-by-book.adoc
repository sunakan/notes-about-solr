結論：ZooKeeperを学ぶという感じになりそう??

= 8. クラスタ構築の運用

* 8.1 単一ノードの限界
* 8.2 分散インデックスと分散検索
** 8.2.1 分散インデックス
** 8.2.2 分散検索
** 8.2.3 分散インデックスのセットアップ
** 8.2.4 分散インデクシングと分散検索の実行
** 8.2.5 分散検索のエラー回避
* 8.3 レプリケーション
** 8.3.1 レプリケーションの概要
** 8.3.2 マスタ/スレーブの設定方法と設定項目
** 8.3.3 マスタ/スレーブのセットアップ
** 8.3.4 レプリケーションの確認
* 8.4 レガシーなクラスタ
** 8.4.1 レガシーなクラスタを構築する準備
** 8.4.2 レガシーなクラスタの構築
** 8.4.3 分散インデクシングと分散検索
* 8.5 SolrCloud
** 8.5.1 ZooKeeperのインストールと起動
** 8.5.2 SolrCloud構築
** 8.5.3 分散インデクシングと分散検索、レプリケーション
** 8.5.4 フェールオーバー
** 8.5.5 インデックスのリカバリ
** 8.5.6 リーダーの選出
** 8.5.7 SolrCloudの拡張

== 8.1 単一ノードの限界
* 理論上のMAX:21億のドキュメント
** `ドキュメント` = Solrに登録されるデータ(フォーマットはjson,xml,csv等)
*** 例："Pythonリスト"で検索すると、"Python"と"リスト"に分割してそれぞれ含むドキュメントがヒットします。
*** 例：JSONファイルでドキュメントを登録
*** 例：バイナリ形式ドキュメントのインデクシング
* ただし、先にストレージやメモリの上限にぶち当たりそう
** 大量のインデクシング中に、大量の検索クエリなどを同時にすると、Solrノードがダウンする(or 時間がかかる)恐れもある

== 8.2 分散インデックスと分散検索
* ストレージ容量が足りなくなるという問題
** 解決策：分散インデックス(Distributed Index)と分割検索(Distributed Search)
*** 分散インデックス：1つの大きなインデックスを小さなインデックスに分割し、複数のノードに分散配置
*** 分散検索：複数ノードに分散配置されたインデックス(=シャード：Shard)を一括して検索をかける

=== 8.2.1 分散インデックス
* 複数のノードで、1つの巨大なインデックスを実現
* メリット
** 1ノードあたりのストレージ利用量を削減可能
* 注意
** 登録クライアント側で、node1、node2にドキュメントを振り分ける必要がある
** バックアップではない

=== 8.2.2 分散検索

* 分散インデックス(シャード)を検索する機能 = 分散検索
* メリット
** 検索の実行時間の短縮にもつながる
* 注意
** それぞれのノードから返却された検索結果をマージする処理が別途必要になる(インデックスの検索に比べれば比較的軽い処理らしい)
* よくわからん
** shardsパラメータで、検索対象のインデックス(シャード)を持つノードを指定するだけ
*** 検索対象のインデックスを事前に知っておく必要がある...?
** シャードをもつノードがいることになる

=== 8.2.3 分散インデックスのセットアップ
=== 8.2.4 分散インデクシングと分散検索の実行
=== 8.2.5 分散検索のエラー回避

== 8.3 レプリケーション
* インデックスの複製(=レプリカ)
* 実現できること
** 負荷分散と対障害性

=== 8.3.1 レプリケーションの概要
* Solrのレプリケーションは、リクエストハンドラとして実装
** 検索やインデクシングと同様
** = shellやrsyncなどの外部ツールを使用しない方法で提供

=== 8.3.2 マスタ/スレーブの設定方法と設定項目
=== 8.3.3 マスタ/スレーブのセットアップ
=== 8.3.4 レプリケーションの確認
== 8.4 レガシーなクラスタ
=== 8.4.1 レガシーなクラスタを構築する準備
=== 8.4.2 レガシーなクラスタのæ§築
=== 8.4.3 分散インデクシングと分散検索

== 8.5 SolrCloud
* レガシーなクラスタ構成では、成長につれ重くなっていく
** 障害ポイントが増える
** 設定ファイルの管理
** 障害対応などのクラスタ管理者のオペレーションコスト

* SolrCloud = クラスタ構成の運用、管理コストを最小限にすることを目標にした分散環境の仕組み
** SolrCloudを使わなくても、分散インデックス、分散検索、クラスタリングは可能 (成長するにつれコストが嵩んでいく)
** 結局コストは0にはならないので、小さいやつだと過剰になる可能性がありそう

=== 8.5.1 ZooKeeperのインストールと起動
* ZooKeeper
** SolrCloudの核
** クラスタ情報を中央管理する

=== 8.5.2 SolrCloud構築
=== 8.5.3 分散インデクシングと分散検索、レプリケーション
=== 8.5.4 フェールオーバー
=== 8.5.5 インデックスのリカバリ
=== 8.5.6 リーダーの選出
=== 8.5.7 SolrCloudの拡張
